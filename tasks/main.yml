---
# tasks file for ucarp

- fail:
    msg: "Failing, Require to setup ucarp__interface variable"
  when: ucarp__interface is not defined

- name: "Install ucarp"
  apt:
    name: ucarp
    state: present

- name: "Make sure network configuration source interfaces.d/"
  lineinfile:
    dest: /etc/network/interfaces
    line: "source /etc/network/interfaces.d/*"
    state: present
    backup: true


- name: "Configure ucarp interface"
  template:
    src: interfaces-ucarp.j2
    dest: "/etc/network/interfaces.d/{{ ucarp__interface }}:ucarp"
    mode: 0444
    owner: root
    group: root
    backup: true
